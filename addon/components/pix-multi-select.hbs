<div
  class="pix-multi-select"
  {{on-click-outside this.hideDropDown}}
  {{on-arrow-down-up-action this.listId this.showDropDown this.isExpanded}}
  {{on-escape-action this.hideDropDown @id}}
>

  {{#if @isSearchable}}
    <label
      for={{@id}}
      class="pix-multi-select__label{{if @screenReaderOnly ' screen-reader-only'}}"
    >{{@label}}</label>
    <span class="pix-multi-select-header{{if @className this.className}}">
      <FaIcon @icon="magnifying-glass" class="pix-multi-select-header__search-icon" />

      <input
        class="pix-multi-select-header__search-input"
        id={{@id}}
        type="text"
        name={{@id}}
        placeholder={{this.placeholder}}
        autocomplete="off"
        {{on "input" this.updateSearch}}
        {{on "click" this.toggleDropDown}}
        aria-expanded={{this.isAriaExpanded}}
        aria-controls={{this.listId}}
        aria-haspopup="menu"
        ...attributes
      />
    </span>
  {{else}}
    <span
      id={{this.labelId}}
      class="pix-multi-select__label{{if @screenReaderOnly ' screen-reader-only'}}"
    >{{@label}}</span>

    <button
      aria-labelledby={{this.labelId}}
      id={{@id}}
      type="button"
      aria-expanded={{this.isAriaExpanded}}
      aria-controls={{this.listId}}
      aria-haspopup="menu"
      class="pix-multi-select-header{{if @className this.className}}"
      {{on "click" this.toggleDropDown}}
      ...attributes
    >
      {{this.placeholder}}
      <FaIcon
        class="pix-multi-select-header__dropdown-icon
          {{if this.isExpanded ' pix-multi-select-header__dropdown-icon--expand'}}"
        @icon={{if this.isExpanded "chevron-up" "chevron-down"}}
      />
    </button>
  {{/if}}

  <ul
    class="pix-multi-select-list {{unless this.isExpanded 'pix-multi-select-list--hidden'}}"
    id={{this.listId}}
    aria-multiselectable="true"
    role="menu"
  >
    {{#if (gt this.results.length 0)}}
      {{#each this.results as |option|}}
        <li class="pix-multi-select-list__item" role="menuitem">
          <PixCheckbox
            @id={{concat @id "-" option.value}}
            @checked={{option.checked}}
            value={{option.value}}
            {{on "change" this.onSelect}}
            {{on-enter-action this.hideDropDown @id}}
            tabindex={{if this.isExpanded "0" "-1"}}
          >
            {{yield option}}
          </PixCheckbox>
        </li>
      {{/each}}
    {{else if this.isLoadingOptions}}
      <li
        class="pix-multi-select-list__item pix-multi-select-list__item--no-result"
      >{{@loadingMessage}}</li>
    {{else}}
      <li
        class="pix-multi-select-list__item pix-multi-select-list__item--no-result"
      >{{@emptyMessage}}</li>
    {{/if}}
  </ul>
</div>