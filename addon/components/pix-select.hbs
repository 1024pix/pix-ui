{{! template-lint-disable no-down-event-binding }}
<div
  class="pix-select"
  {{on-click-outside this.hideDropdown}}
  {{on-arrow-down-up-action this.listId this.showDropdown this.isExpanded}}
  {{on-escape-action this.hideDropdown}}
  {{on "keydown" this.lockTab}}
>
  <div class="{{if @screenReaderOnly 'screen-reader-only'}}">
    <label for={{this.selectId}} class="pix-select__label">
      {{#if @requiredLabel}}
        <abbr class="mandatory-mark" title="{{@requiredLabel}}" aria-hidden="true">*</abbr>
      {{/if}}
      {{@label}}
    </label>

    {{#if @subLabel}}
      <span class="pix-select__sub-label">{{@subLabel}}</span>
    {{/if}}
  </div>

  <button
    type="button"
    id={{this.selectId}}
    class="pix-select-button{{this.className}}"
    {{on "click" this.toggleDropdown}}
    aria-expanded={{this.isAriaExpanded}}
    aria-controls={{this.listId}}
    aria-required="{{if @requiredLabel 'true' 'false'}}"
  >
    {{this.placeholder}}

    <FaIcon
      class="pix-select-button__dropdown-icon"
      @icon={{if this.isExpanded "chevron-up" "chevron-down"}}
    />
  </button>
  <div class="pix-select__dropdown{{unless this.isExpanded ' pix-select__dropdown--closed'}}"
    {{#if @isSearchable}}

      <input
        id={{this.selectId}}
        list="{{this.datalistId}}"
        {{on "input" this.onChangeOld}}
        class="{{if this.isValid 'pix-select--is-valid'}} {{if this.isBig 'pix-select--big'}}"
        ...attributes
        autocomplete="off"
      />

      <datalist id={{this.datalistId}}>
        {{#each @options as |opt|}}
          <option label={{opt.label}}>{{opt.label}}</option>
        {{/each}}
      </datalist>

    {{else}}
      <div role="listbox" id={{this.listId}} class="pix-select__options">
        <li
          class="pix-select-options-category__option{{unless
            @value
            ' pix-select-options-category__option--selected'
          }}"
          role="option"
          tabindex={{if this.isExpanded "0" "-1"}}
          aria-selected={{if @value "false" "true"}}
          {{on "click" (fn this.onChange this.defaultOption)}}
          {{on-enter-action (fn this.onChange this.defaultOption)}}
        >
          {{@placeholder}}
        </li>
      </div>
    {{/if}}
  </div>
</div>